请用 Flutter 开发一个 **Windows 桌面应用**，项目名为 **「端口哨兵 Port Sentinel」**，用于在开发过程中快速排查端口占用，并支持一键杀进程。

### 一、项目目标

- 目标平台：**Windows 10+ 桌面端**（Flutter Windows 桌面应用）。
- 主要用途：开发者遇到端口冲突时，快速查看当前端口与进程占用情况，并能按端口或进程名搜索、结束进程。
- 要求界面简洁、操作直观，适合高频日常使用。

### 二、核心功能需求

1. **端口与进程列表展示**

   - 扫描当前系统中所有 **正在监听或占用的端口**（至少支持 TCP，最好同时支持 UDP）。
   - 列表中每行展示信息包括但不限于：
     - 端口号
     - 协议（TCP/UDP）
     - 本地地址（IP）
     - 远端地址（如有）
     - 进程 PID
     - 进程名称
     - 可执行文件路径（如果能获取到）
   - 支持按列排序（例如按端口、PID、进程名排序）。

2. **搜索与筛选**

   - 顶部提供搜索框和筛选区：
     - 支持根据 **端口号** 搜索（精确匹配或模糊匹配均可，但要说明规则）。
     - 支持根据 **进程名** 搜索（模糊匹配）。
   - 支持简单筛选：
     - 仅显示某个端口范围（如 0–1024、1024–65535，可选）。
     - 按协议筛选（TCP/UDP）。

3. **根据端口/进程结束任务（杀进程）**

   - 在列表中选中一行后，可以点击「结束进程」按钮：
     - 实际行为是根据选中条目的 PID 结束对应进程。
   - 支持通过端口号快速操作：
     - 用户输入端口号，系统找到对应进程并提供「结束进程」入口。
   - 必须有 **二次确认弹窗**，提示：
     - 将要结束的 PID、进程名、端口号。
   - 杀进程成功或失败时，弹出提示（Toast 或对话框），失败时显示错误原因（如权限不足等）。

4. **数据刷新与状态提示**

   - 提供「刷新」按钮，重新扫描当前端口和进程占用情况。
   - 可选：支持 **定时自动刷新**，例如每 5 秒或 10 秒（用户可手动开启/关闭）。
   - 在扫描或杀进程等耗时操作时：
     - 显示加载状态（全局或局部 loading）。
     - 避免界面卡死。

5. **权限与安全**
   - 在 Windows 上可能需要以管理员权限运行才能获取完整端口信息和杀进程。
   - 如果权限不足时：
     - 要有清晰的错误提示（例如：请以管理员权限运行本程序）。

### 三、技术实现建议（Windows 端口 + 进程）

- 使用 Dart/Flutter 调用 Windows 系统命令或 API 获取信息，例如：
  - 通过执行系统命令：
    - `netstat -ano` 获取端口与 PID 对应关系。
    - `tasklist` 或其他命令获取 PID 对应的进程名称与路径。
  - 或者使用现有的 Dart/Flutter 第三方包 / Win32 API 完成同样功能。
- 实现一个 **数据解析层**：
  - 负责解析 `netstat`、`tasklist` 输出（或 API 返回值），构建内部数据模型。
  - 要考虑中文和英文系统环境下命令输出格式的差异，尽量写得鲁棒一些。
- 实现一个 **进程管理服务**：
  - 封装结束进程的能力（例如调用 `taskkill /PID xxx /F`，或使用 Win32 API）。
  - 提供统一的错误处理和返回结果。

### 四、架构与代码结构（建议）

请使用清晰的分层结构，便于后续扩展：

1. **数据模型（models）**

   - `PortInfo`：表示端口占用信息，字段包括端口号、协议、本地/远程地址、PID 等。
   - `ProcessInfo`：表示进程信息，字段包括 PID、进程名、可执行路径等。
   - 可以有一个组合模型 `PortProcessItem` 表示展示在 UI 上的一条记录。

2. **数据源与仓库（services/repositories）**

   - `SystemPortRepository` 或类似类名：
     - 提供获取当前端口占用列表的方法，如 `Future<List<PortProcessItem>> fetchPortProcessList();`
   - `ProcessManager`：
     - 提供结束进程方法，如 `Future<KillResult> killProcess(int pid);`

3. **状态管理**

   - 你可以选择 Flutter 中常见的一种状态管理方式（如 Provider、Riverpod、Bloc 等），但请保证：
     - 状态与 UI 解耦清晰。
     - 列表加载、加载中状态、错误状态等有明确表示。
   - 需要处理的状态包括：
     - 初始化加载
     - 刷新中
     - 搜索条件变化
     - 杀进程中/杀进程结果

4. **UI 布局**
   - 典型桌面布局：
     - 顶部：标题栏 + 搜索区域（端口输入框、进程名输入框、搜索按钮、刷新按钮）。
     - 中间：可滚动列表/表格，显示端口 + 进程信息。
     - 底部或右上角：状态提示区域（如当前记录总数、刷新时间、自动刷新开关）。
   - 设计风格简洁现代，适配 Windows 桌面窗口尺寸变化（简单响应式即可）。

### 五、用户体验细节

- 支持键盘操作：
  - 搜索框回车即触发搜索。
  - 列表中上下方向键选择记录，回车或快捷键触发「结束进程」（可选）。
- 列表中明确区分 **本机监听端口** 和 **已有连接的端口**（例如使用不同颜色或标签区分）。
- 当没有任何匹配结果时，显示「未找到匹配的端口/进程」友好提示，而不是空白界面。

### 六、代码质量与扩展性

- 请保证代码结构清晰、可维护：
  - 合理拆分文件和类。
  - 对复杂的解析逻辑、进程管理逻辑编写单元测试或至少保留易懂的逻辑结构。
- 预留扩展能力：
  - 未来可能增加「端口历史记录」「常用端口监控」等功能，请把当前设计做得相对通用。
